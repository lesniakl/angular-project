import{a as p}from"./chunk-GJZBLMNK.js";import{a as u}from"./chunk-UNDOHNHE.js";import{a as c}from"./chunk-ZECISSPR.js";import{a as o,b as m,c as f,d as a,h as b}from"./chunk-SDUPZHXZ.js";import{g as l}from"./chunk-2R6CW7ES.js";var v=":host{display:inline-block;position:relative;min-height:2rem;height:auto;border-radius:var(--theme-input--border-radius)}:host *,:host *::after,:host *::before{box-sizing:border-box}:host ::-webkit-scrollbar-button{display:none}@-moz-document url-prefix(){:host *{scrollbar-color:var(--theme-scrollbar-thumb--background) var(--theme-scrollbar-track--background);scrollbar-width:thin}}:host ::-webkit-scrollbar{width:0.5rem;height:0.5rem}:host ::-webkit-scrollbar-track{border-radius:5px;background:var(--theme-scrollbar-track--background)}:host ::-webkit-scrollbar-track:hover{background:var(--theme-scrollbar-track--background--hover)}:host ::-webkit-scrollbar-thumb{border-radius:5px;background:var(--theme-scrollbar-thumb--background)}:host ::-webkit-scrollbar-thumb:hover{background:var(--theme-scrollbar-thumb--background--hover)}:host ::-webkit-scrollbar-corner{display:none}:host .d-none{display:none}:host .select{position:relative;display:flex;align-items:center;background-color:var(--theme-input--background);border:var(--theme-input--border-thickness) solid var(--theme-input--border-color);border-radius:var(--theme-input--border-radius);padding:0 0 0 0.5rem;box-shadow:var(--theme-inset-shadow-1) !important}:host .select:not(.disabled):not(:disabled){cursor:pointer}:host .select:not(.disabled):not(:disabled):hover{background-color:var(--theme-input--background--hover);border-color:var(--theme-input--border-color--hover)}:host .select:focus-within{background-color:var(--theme-input--background--focus);border-color:var(--theme-input--border-color--focus);outline:1px solid #119fff;outline-offset:var(--theme-input--focus--outline-offset)}:host .select.readonly,:host .select.disabled{box-shadow:none !important;border:none;border-radius:0;cursor:pointer}:host .select.readonly,:host .select.readonly:hover,:host .select.readonly:active,:host .select.disabled,:host .select.disabled:hover,:host .select.disabled:active{background-color:transparent !important}:host .select.readonly:focus,:host .select.readonly:focus-within,:host .select.readonly:focus-visible,:host .select.disabled:focus,:host .select.disabled:focus-within,:host .select.disabled:focus-visible{outline:none}:host .select.readonly input:focus,:host .select.readonly input:focus-visible,:host .select.disabled input:focus,:host .select.disabled input:focus-visible{outline:none}:host .select.disabled{border-bottom:var(--theme-input--border-thickness) solid var(--theme-color-weak-bdr)}:host .select.disabled input{color:var(--theme-color-weak-text)}:host .select.readonly{border-bottom:var(--theme-input--border-thickness) solid var(--theme-color-soft-bdr)}:host .select.readonly input{color:var(--theme-color-std-text)}:host .hidden{display:none !important}:host .trigger{display:flex;align-items:center;flex-grow:1;height:100%}:host .input-container{display:flex;position:relative;align-items:flex-start;width:100%;height:100%}:host .input-container .chips{position:relative;display:flex;align-items:center;flex-wrap:wrap;height:100%;max-height:3.5rem;flex-grow:1;overflow-y:auto}:host .input-container .chips>ix-filter-chip{margin:0.1rem}:host .input-container input{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;-webkit-font-smoothing:antialiased;-moz-osx-font-smooting:grayscale;font-family:Siemens Sans, sans-serif;font-size:0.875rem;font-weight:400;line-height:1.429em;color:var(--theme-color-std-text);background:transparent;height:1.75rem;width:100%}:host .input-container input,:host .input-container input:hover,:host .input-container input:focus-visible{border:none;outline:none}:host .input-container input::-moz-placeholder{color:var(--theme-input-select-icon--color)}:host .input-container input::placeholder{color:var(--theme-input-select-icon--color)}:host .input-container input.hide-placeholder::-moz-placeholder{opacity:0}:host .input-container input.hide-placeholder::placeholder{opacity:0}:host .dropdown-visible{--ix-icon-button-color:var(--theme-color-dynamic--hover)}:host .add-item{display:flex;justify-content:flex-start;align-items:center;position:relative;width:100%}:host .select-list-header{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:flex;align-items:center;height:2rem;color:var(--theme-select-list-item-hint--color);margin:0 0.5rem 0 1rem}",g=v,I=function(e,i,s,t){var n=arguments.length,r=n<3?i:t===null?t=Object.getOwnPropertyDescriptor(i,s):t,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(e,i,s,t);else for(var h=e.length-1;h>=0;h--)(d=e[h])&&(r=(n<3?d(r):n>3?d(i,s,r):d(i,s))||r);return n>3&&r&&Object.defineProperty(i,s,r),r},w=class{constructor(e){b(this,e),this.valueChange=a(this,"valueChange",7),this.itemSelectionChange=a(this,"itemSelectionChange",7),this.inputChange=a(this,"inputChange",7),this.addItem=a(this,"addItem",7),this.focusControllerCallbackBind=this.focusDropdownItem.bind(this),this.itemObserver=c(()=>{this.arrowFocusController.items=this.visibleNonShadowItems}),this.selectedIndices=void 0,this.value=void 0,this.allowClear=!1,this.mode="single",this.editable=!1,this.disabled=!1,this.readonly=!1,this.i18nPlaceholder="Select an option",this.i18nPlaceholderEditable="Type of select option",this.i18nSelectListHeader="Please select an option",this.i18nNoMatches="No matches",this.hideListHeader=!1,this.dropdownShow=!1,this.selectedLabels=void 0,this.dropdownWrapperRef=void 0,this.dropdownAnchor=void 0,this.isDropdownEmpty=!1,this.navigationItem=void 0,this.inputFilterText=void 0,this.inputValue=void 0}get nonShadowItems(){return Array.from(this.hostElement.querySelectorAll("ix-select-item"))}get visibleNonShadowItems(){return this.nonShadowItems.filter(e=>!e.classList.contains("d-none"))}get shadowItems(){return Array.from(this.hostElement.shadowRoot.querySelectorAll("ix-select-item"))}get visibleShadowItems(){return this.shadowItems.filter(e=>!e.classList.contains("d-none"))}get items(){return[...this.nonShadowItems,...this.shadowItems]}get visibleItems(){return this.items.filter(e=>!e.classList.contains("d-none"))}get selectedItems(){return this.items.filter(e=>e.selected)}get addItemButton(){return this.hostElement.shadowRoot.querySelector(".add-item")}get isSingleMode(){return this.mode==="single"}get isMultipleMode(){return this.mode==="multiple"}get isEveryDropdownItemHidden(){return this.items.every(e=>e.classList.contains("d-none"))}watchSelectedIndices(e){this.value=e,this.updateSelection()}watchValue(e){this.selectedIndices=e,this.updateSelection()}watchDropdownShow(e){e?(this.arrowFocusController=new p(this.visibleNonShadowItems,this.dropdownRef,this.focusControllerCallbackBind),this.arrowFocusController.wrap=!this.editable,this.itemObserver.observe(this.dropdownRef,{childList:!0,subtree:!0})):(this.arrowFocusController.disconnect(),this.arrowFocusController=void 0,this.itemObserver.disconnect())}onItemClicked(e){let i=e.detail;this.itemClick(i)}focusDropdownItem(e){var i;if(this.navigationItem=void 0,e<this.visibleNonShadowItems.length){let s=(i=this.visibleNonShadowItems[e])===null||i===void 0?void 0:i.shadowRoot.querySelector("ix-dropdown-item");requestAnimationFrame(()=>{s.shadowRoot.querySelector("button").focus()})}}itemClick(e){let i=this.toggleValue(e);this.emitValueChange(i)||(this.value=i,this.updateSelection())}emitAddItem(e){if(e===void 0||e.trim()==="")return!1;let{defaultPrevented:i}=this.addItem.emit(e);if(i)return!0;let s=document.createElement("ix-select-item");return s.value=e,s.label=e,this.customItemsContainerRef.appendChild(s),this.clearInput(),this.itemClick(e),!1}toggleValue(e){if(!this.isMultipleMode)return e;if(!this.value)return[e];let i=this.value;return Array.isArray(i)||(i=[i]),i.includes(e)?i.filter(s=>s!==e):[...i,e]}updateSelection(){var e;let i=[];if(this.value&&(i=Array.isArray(this.value)?[...this.value]:[this.value]),this.items.forEach(s=>{s.selected=i.some(t=>typeof t!=typeof s.value?t.toString()===s.value.toString():t===s.value)}),this.selectedLabels=this.selectedItems.map(s=>s.label),this.isSingleMode&&(!((e=this.selectedLabels)===null||e===void 0)&&e.length)){this.inputValue=this.selectedLabels[0],this.inputRef&&(this.inputRef.value=this.inputValue);return}this.inputValue=null}emitValueChange(e){let{defaultPrevented:i}=this.valueChange.emit(e);return i?!0:(e?this.itemSelectionChange.emit(Array.isArray(e)?e:[e]):this.itemSelectionChange.emit(null),!1)}componentDidLoad(){this.inputRef.addEventListener("input",()=>{this.dropdownShow=!0,this.inputChange.emit(this.inputRef.value)})}componentWillLoad(){this.selectedIndices&&!this.value&&(this.value=this.selectedIndices),this.updateSelection()}onLabelChange(e){e.preventDefault(),e.stopImmediatePropagation(),this.updateSelection()}disconnectedCallback(){this.itemMutationObserver&&this.itemMutationObserver.disconnect()}itemExists(e){return this.items.find(i=>i.label===e)}dropdownVisibilityChanged(e){this.dropdownShow=e.detail,e.detail?(this.inputRef.focus(),this.inputRef.select(),this.removeHiddenFromItems(),this.isDropdownEmpty=this.isEveryDropdownItemHidden):(this.navigationItem=void 0,this.updateSelection(),this.inputFilterText="")}onKeyDown(e){return l(this,null,function*(){(e.code==="ArrowDown"||e.code==="ArrowUp")&&(yield this.onArrowNavigation(e,e.code)),this.dropdownShow&&((e.code==="Enter"||e.code==="NumpadEnter")&&(yield this.onEnterNavigation()),e.code==="Escape"&&(this.dropdownShow=!1))})}onEnterNavigation(){return l(this,null,function*(){var e;if(this.isMultipleMode)return;let i;if(this.editable&&!this.itemExists(this.inputFilterText)){if(this.emitAddItem(this.inputFilterText))return;i=this.items[this.items.length-1]}i&&i.onItemClick(),yield(e=this.dropdownRef)===null||e===void 0?void 0:e.updatePosition(),this.isSingleMode&&!this.editable&&(this.dropdownShow=!1)})}onArrowNavigation(e,i){return l(this,null,function*(){if(e.defaultPrevented)return;if(e.preventDefault(),e.stopPropagation(),this.dropdownShow=!0,!this.navigationItem&&document.activeElement===this.hostElement){this.visibleItems.length?this.applyFocusTo(this.visibleItems.shift()):this.isAddItemVisible()&&this.focusAddItemButton();return}let s=i==="ArrowUp",t=this.visibleNonShadowItems.indexOf(document.activeElement);if(t===0){!this.visibleShadowItems.length&&this.isAddItemVisible()?this.focusAddItemButton():this.applyFocusTo(this.visibleShadowItems.pop());return}else if(t!==-1&&t===this.visibleNonShadowItems.length-1){this.visibleShadowItems.length?this.applyFocusTo(this.visibleShadowItems.shift()):this.isAddItemVisible()&&this.focusAddItemButton();return}if(this.isAddItemVisible()&&this.addItemRef.contains(yield this.navigationItem.getDropdownItemElement())){s?this.applyFocusTo(this.visibleItems.pop()):this.visibleItems.length&&this.applyFocusTo(this.visibleItems.shift());return}let n=this.visibleShadowItems.indexOf(this.navigationItem);s?n===0?this.visibleNonShadowItems.length?this.applyFocusTo(this.visibleNonShadowItems.pop()):this.isAddItemVisible()&&this.focusAddItemButton():this.applyFocusTo(this.visibleShadowItems[n-1]):n===this.visibleShadowItems.length-1?this.isAddItemVisible()?this.focusAddItemButton():this.applyFocusTo(this.visibleItems.shift()):this.applyFocusTo(this.visibleShadowItems[n+1])})}applyFocusTo(e){e&&(this.navigationItem=e,setTimeout(()=>{e.shadowRoot.querySelector("ix-dropdown-item").shadowRoot.querySelector("button").focus()}))}focusAddItemButton(){this.addItemButton&&(this.addItemButton.shadowRoot.querySelector("button").focus(),this.navigationItem=this.addItemRef)}filterItemsWithTypeahead(){this.inputFilterText=this.inputRef.value,!(this.isSingleMode&&this.inputFilterText===this.selectedLabels[0])&&(this.inputFilterText?this.items.forEach(e=>{e.classList.remove("d-none"),e.label.toLowerCase().includes(this.inputFilterText.toLowerCase())||e.classList.add("d-none")}):this.removeHiddenFromItems(),this.arrowFocusController&&(this.arrowFocusController.items=this.visibleNonShadowItems),this.isDropdownEmpty=this.isEveryDropdownItemHidden)}removeHiddenFromItems(){this.items.forEach(e=>{e.classList.remove("d-none")})}clearInput(){this.inputRef.value="",this.inputFilterText=""}clear(){this.clearInput(),this.selectedLabels=[],this.value=[],this.valueChange.emit(null),this.dropdownShow=!1}onInputBlur(e){this.editable||this.isSingleMode||!this.dropdownShow&&this.mode!=="multiple"&&(e.target.value=this.selectedLabels)}placeholderValue(){return this.disabled||this.readonly?"":this.editable?this.i18nPlaceholderEditable:this.i18nPlaceholder}isAddItemVisible(){return!this.itemExists(this.inputFilterText)&&this.editable&&this.inputFilterText}render(){var e,i,s;return o(m,{key:"ef836653267a38d82ead34cf82285997083f4086"},o("div",{key:"23e903c9849f58f70d9c843a7258f913d6811cf2",class:{select:!0,disabled:this.disabled,readonly:this.readonly},ref:t=>{this.dropdownAnchor=t,this.editable||(this.dropdownWrapperRef=t)}},o("div",{key:"56b38a998a44ddc6b8f380cc049e813be30ad711",class:"input-container"},o("div",{key:"b3e152d2ab35f3e2bcf2ac8c8df4cb3bc97f6e3c",class:"chips"},this.isMultipleMode?(e=this.selectedItems)===null||e===void 0?void 0:e.map(t=>o("ix-filter-chip",{disabled:this.disabled||this.readonly,key:t.value,onCloseClick:n=>{n.preventDefault(),n.stopPropagation(),this.itemClick(t.value)}},t.label)):"",o("div",{key:"f411e24b3c4512731593a4afd5c51f0223254cc9",class:"trigger"},o("input",{key:"3c16a408ed58a3d2430ed86df32b6d990acb2b49",autocomplete:"off","data-testid":"input",disabled:this.disabled,readOnly:this.readonly,type:"text",class:{"allow-clear":this.allowClear&&!!(!((i=this.selectedLabels)===null||i===void 0)&&i.length)},placeholder:this.placeholderValue(),value:this.inputValue,ref:t=>this.inputRef=t,onBlur:t=>this.onInputBlur(t),onFocus:()=>{this.navigationItem=void 0},onInput:()=>this.filterItemsWithTypeahead(),onKeyDown:t=>this.onKeyDown(t)}),this.allowClear&&(!((s=this.selectedLabels)===null||s===void 0)&&s.length||this.inputFilterText)?o("ix-icon-button",{class:"clear",icon:"clear",ghost:!0,oval:!0,size:"16",onClick:t=>{t.preventDefault(),t.stopPropagation(),this.clear()}}):null,this.disabled||this.readonly?null:o("ix-icon-button",{"data-select-dropdown":!0,class:{"dropdown-visible":this.dropdownShow},icon:"chevron-down-small",ghost:!0,ref:t=>{this.editable&&(this.dropdownWrapperRef=t)}}))))),o("ix-dropdown",{key:"6c838166f4366d760f30dc102d3dad4611b369b5",ref:t=>this.dropdownRef=t,show:this.dropdownShow,closeBehavior:this.isMultipleMode?"outside":"both",class:{"d-none":this.disabled||this.readonly},anchor:this.dropdownAnchor,trigger:this.dropdownWrapperRef,onShowChanged:t=>this.dropdownVisibilityChanged(t),placement:"bottom-start",overwriteDropdownStyle:()=>l(this,null,function*(){return{minWidth:`${this.hostElement.clientWidth}px`}})},o("div",{key:"8f7b41436b7f15311dd4d46cbacbb95879de501e",class:{"select-list-header":!0,hidden:this.hideListHeader||this.isDropdownEmpty},title:this.i18nSelectListHeader,onClick:t=>t.preventDefault()},this.i18nSelectListHeader),o("slot",{key:"dc2913881d407f2cdaaa30efc15fa05193117b1c"}),o("div",{key:"706abca5e8fef621d36b560b6ca5629c235a6a32",ref:t=>this.customItemsContainerRef=t,class:"d-contents"}),this.isAddItemVisible()?o("ix-dropdown-item",{"data-testid":"add-item",icon:"plus",class:{"add-item":!0},label:this.inputFilterText,onItemClick:t=>{t.preventDefault(),this.emitAddItem(this.inputFilterText)&&t.stopPropagation()},onFocus:()=>this.navigationItem=this.addItemRef,ref:t=>{this.addItemRef=t}}):null,this.isDropdownEmpty&&!this.editable?o("div",{class:"select-list-header"},this.i18nNoMatches):""))}get hostElement(){return f(this)}static get watchers(){return{selectedIndices:["watchSelectedIndices"],value:["watchValue"],dropdownShow:["watchDropdownShow"]}}};I([u("keydown",e=>e.dropdownShow)],w.prototype,"onKeyDown",null);w.style=g;export{w as ix_select};
